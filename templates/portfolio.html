{% extends 'base.html' %}
{% load static %}

{% block title %}Portfolio - Custom Millwork Gallery{% endblock %}
{% block description %}Explore our portfolio of custom millwork projects including kitchen cabinets, furniture, and architectural woodwork.{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="relative bg-gradient-to-br from-card to-background py-20 lg:py-32">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center">
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-heading font-bold text-card-foreground leading-tight mb-6">
                <span x-show="language === 'en'">Our Portfolio</span>
                <span x-show="language === 'ar'">معرض أعمالنا</span>
            </h1>
            <p class="text-lg md:text-xl text-muted-foreground leading-relaxed max-w-3xl mx-auto">
                <span x-show="language === 'en'">Discover our collection of custom millwork projects that showcase the perfect blend of craftsmanship, functionality, and design excellence.</span>
                <span x-show="language === 'ar'">اكتشف مجموعتنا من مشاريع الأعمال الخشبية المخصصة التي تعرض المزج المثالي بين الحرفية والوظائف والتميز في التصميم.</span>
            </p>
        </div>
    </div>
</section>

<!-- Category Filter -->
<section class="py-8 bg-card">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex flex-wrap gap-4 justify-center">
            <a href="{% url 'portfolio' %}" class="{% if not current_category %}bg-primary text-primary-foreground{% else %}bg-background text-foreground hover:bg-primary hover:text-primary-foreground{% endif %} px-6 py-2 rounded-lg font-medium transition-colors">
                <span x-show="language === 'en'">All Projects</span>
                <span x-show="language === 'ar'">جميع المشاريع</span>
            </a>
            {% for category_code, category_name in categories %}
            <a href="{% url 'portfolio' %}?category={{ category_code }}" class="{% if current_category == category_code %}bg-primary text-primary-foreground{% else %}bg-background text-foreground hover:bg-primary hover:text-primary-foreground{% endif %} px-6 py-2 rounded-lg font-medium transition-colors">
                <span x-show="language === 'en'">{{ category_name }}</span>
                <span x-show="language === 'ar'">{{ category_name }}</span>
            </a>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Projects Grid -->
<section class="py-20 bg-background">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            {% for project in projects %}
            <div class="group hover-lift animate-fade-in-up animate-delay-{{ forloop.counter0|divisibleby:3|yesno:'100,200,300' }}" x-data="{ currentSlide: 0, totalSlides: {{ project.additional_images.count|add:1 }} }">
                <div class="overflow-hidden rounded-lg relative image-zoom-container">
                    {% if project.additional_images.all %}
                    <!-- Image Slider -->
                    <div class="relative w-full h-64">
                        <!-- Main Image -->
                        <div x-show="currentSlide === 0" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="absolute inset-0">
                            <img src="{{ project.image.url }}" alt="{{ project.title }}" class="w-full h-full object-cover">
                        </div>
                        
                        <!-- Additional Images -->
                        {% for img in project.additional_images.all %}
                        <div x-show="currentSlide === {{ forloop.counter }}" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="absolute inset-0">
                            <img src="{{ img.image.url }}" alt="{{ img.caption|default:project.title }}" class="w-full h-full object-cover">
                        </div>
                        {% endfor %}
                        
                        <!-- Navigation Arrows -->
                        <button @click="currentSlide = currentSlide > 0 ? currentSlide - 1 : totalSlides - 1" class="absolute left-2 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white rounded-full p-2 transition-all">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                            </svg>
                        </button>
                        <button @click="currentSlide = currentSlide < totalSlides - 1 ? currentSlide + 1 : 0" class="absolute right-2 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white rounded-full p-2 transition-all">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                            </svg>
                        </button>
                        
                        <!-- Dot Indicators -->
                        <div class="absolute bottom-3 left-0 right-0 flex justify-center gap-2">
                            <button @click="currentSlide = 0" class="w-2 h-2 rounded-full transition-all" :class="currentSlide === 0 ? 'bg-white w-6' : 'bg-white/50 hover:bg-white/70'"></button>
                            {% for img in project.additional_images.all %}
                            <button @click="currentSlide = {{ forloop.counter }}" class="w-2 h-2 rounded-full transition-all" :class="currentSlide === {{ forloop.counter }} ? 'bg-white w-6' : 'bg-white/50 hover:bg-white/70'"></button>
                            {% endfor %}
                        </div>
                    </div>
                    {% else %}
                    <!-- Single Image (no slider) -->
                    {% if project.image and project.image.url %}
                        <img src="{{ project.image.url }}" alt="{{ project.title }}" class="w-full h-64 object-cover group-hover:scale-105 transition-transform duration-300">
                    {% else %}
                        <div class="w-full h-64 bg-primary/10 flex items-center justify-center rounded-lg">
                            <svg class="w-20 h-20 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                    {% endif %}
                    {% endif %}
                </div>
                <h3 class="text-xl font-heading font-semibold text-foreground mt-4">
                    <span x-show="language === 'en'">{{ project.title }}</span>
                    <span x-show="language === 'ar'">{{ project.title_arabic|default:project.title }}</span>
                </h3>
                <p class="text-muted-foreground">
                    <span x-show="language === 'en'">{{ project.description|truncatewords:15 }}</span>
                    <span x-show="language === 'ar'">{{ project.description_arabic|default:project.description|truncatewords:15 }}</span>
                </p>
                <p class="text-sm text-primary mt-2">
                    <span x-show="language === 'en'">{{ project.get_category_display }}</span>
                    <span x-show="language === 'ar'">{{ project.get_category_display }}</span>
                </p>
            </div>
            {% empty %}
            <!-- Fallback content if no projects -->
            <div class="col-span-full text-center py-12">
                <svg class="w-20 h-20 text-muted-foreground mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                </svg>
                <h3 class="text-xl font-heading font-semibold text-foreground mb-2">
                    <span x-show="language === 'en'">No Projects Found</span>
                    <span x-show="language === 'ar'">لا توجد مشاريع</span>
                </h3>
                <p class="text-muted-foreground">
                    <span x-show="language === 'en'">Check back soon for our latest projects</span>
                    <span x-show="language === 'ar'">تحقق قريبا من أحدث مشاريعنا</span>
                </p>
            </div>
            {% endfor %}
        </div>

        <!-- Pagination -->
        {% if projects.has_other_pages %}
        <div class="flex justify-center mt-12 gap-2">
            {% if projects.has_previous %}
            <a href="?page={{ projects.previous_page_number }}{% if current_category %}&category={{ current_category }}{% endif %}" class="bg-card text-card-foreground hover:bg-primary hover:text-primary-foreground px-4 py-2 rounded-lg font-medium transition-colors">
                <span x-show="language === 'en'">Previous</span>
                <span x-show="language === 'ar'">السابق</span>
            </a>
            {% endif %}

            <span class="px-4 py-2 text-foreground">
                <span x-show="language === 'en'">Page {{ projects.number }} of {{ projects.paginator.num_pages }}</span>
                <span x-show="language === 'ar'">صفحة {{ projects.number }} من {{ projects.paginator.num_pages }}</span>
            </span>

            {% if projects.has_next %}
            <a href="?page={{ projects.next_page_number }}{% if current_category %}&category={{ current_category }}{% endif %}" class="bg-card text-card-foreground hover:bg-primary hover:text-primary-foreground px-4 py-2 rounded-lg font-medium transition-colors">
                <span x-show="language === 'en'">Next</span>
                <span x-show="language === 'ar'">التالي</span>
            </a>
            {% endif %}
        </div>
        {% endif %}
    </div>
</section>

<!-- Call to Action -->
<section class="py-20 bg-card">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-3xl md:text-4xl font-heading font-bold text-card-foreground mb-6">
            <span x-show="language === 'en'">Ready to Start Your Project?</span>
            <span x-show="language === 'ar'">مستعد لبدء مشروعك؟</span>
        </h2>
        <p class="text-lg text-muted-foreground mb-8">
            <span x-show="language === 'en'">Let's create something extraordinary together. Contact us to discuss your custom millwork vision.</span>
            <span x-show="language === 'ar'">دعنا ننشئ شيئاً استثنائياً معاً. اتصل بنا لمناقشة رؤية أعمالك الخشبية المخصصة.</span>
        </p>
        <a href="{% url 'contact' %}" class="bg-accent text-accent-foreground hover:bg-accent/90 px-8 py-3 rounded-lg font-medium transition-colors">
            <span x-show="language === 'en'">Get Started Today</span>
            <span x-show="language === 'ar'">ابدأ اليوم</span>
        </a>
    </div>
</section>
{% endblock %}